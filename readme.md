# 基于tensorflow2.3的垃圾分类系统
课程设计要做一个垃圾分类系统，需要识别可回收垃圾、厨余垃圾、有害垃圾和其他垃圾等四个大类，在网上找到了很多开源的数据集，但是质量参差不齐，而且有坏图的存在，所以我就将这些数据集还有自己爬取的数据一起清洗了一遍，全部保存为了jpg的格式，数据集包含四大类垃圾：厨余垃圾、可回收物、其他垃圾、有害垃圾共80012张图片（jpg）每个大类下有多个具体类别，具体类别由文件夹名标识，如“厨余垃圾_苹果”、“可回收物_玻璃瓶”等。

数据集按照8:2的比例划分为训练集和验证集，确保模型可以在多样性和充分性上进行学习和验证图像被调整为224x224像素，适配MobileNetV2的输入要求。

模型训练使用的是tensorflow2.3，并使用pyqt5构建了图形化界面。

## 代码结构

```
models 目录下放置训练好的模型
results 目录下放置的是训练的训练过程的一些可视化的图，txt文件是测试结果
utils 主要是中间的一些文件
window.py 是界面文件，主要是利用pyqt5完成的界面，通过电脑摄像头可以对图片种类进行预测
test_model.py 测试文件
train_mobilenet.py 训练代码
预训练模型是文件F:\mobilenet_v2_weights_tf_dim_ordering_tf_kernels_1.0_224_no_top.h5
```

## 效果
在result文件夹下

mobilenet的训练准确率大约95%，验证准确率大约82%，测试准确率68%

分类热力图中，总体来说，四种类别均在0.8以上，模型在“可回收物”和“厨余垃圾”上的准确率较高，在“其他垃圾”和“有害垃圾”上有一定程度的混淆，但这可能与这些类别的视觉特征相对接近有关。

## 如何运行
requirements
本项目在pycharm上运行，建议新建一个conda环境